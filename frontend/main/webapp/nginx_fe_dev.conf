server {
  listen 80 default_server;
  listen [::]:80 default_server;

  # Serve app at /
  root /usr/share/nginx/html;
  index index.html;

  # Main SPA at /
  location / {
    try_files $uri $uri/ /index.html;
    add_header Cache-Control "no-store, no-cache, must-revalidate";
  }

  # Mirror the same app under /ulca/
  # This makes /ulca/static/... resolve to /usr/share/nginx/html/static/...
  location ^~ /ulca/ {
    alias /usr/share/nginx/html/;
    index index.html;

    # Static assets under /ulca/static/ → serve files directly
    location ^~ /ulca/static/ {
      alias /usr/share/nginx/html/static/;
      try_files $uri =404;
      access_log off;
      expires 1y;
    }

    # PWA odds & ends
    location = /ulca/manifest.json { alias /usr/share/nginx/html/manifest.json; access_log off; expires 1h; }
    location = /ulca/favicon.ico   { alias /usr/share/nginx/html/favicon.ico;   access_log off; expires 30d; }

    # SPA fallback when the path under /ulca/ isn’t a file
    try_files $uri $uri/ /ulca/index.html;
  }
}

